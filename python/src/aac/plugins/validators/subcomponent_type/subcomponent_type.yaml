validation:
  name: Reference is type
  description: |
    Verifies that the type referenced by a field matches the expected type.

    This validation takes a list of key-value pairs which are used to define reference type constraints
    for fields. For instance, the KV pair `type: model` would define the field 'type' as model. Any definition
    reference in the field `type` that is not a `model` definition is invalid.

    The valid types can be root keys or schema definition names, and the fields that can be defined must be top-level fields.
  behavior:
    - name: Verify that the definition's fields reference the argument-defined root key types.
      type: request-response
      description:
      input:
        - name: input
          type: ValidatorKeywordInput
      output:
        - name: results
          type: ValidatorOutput
      acceptance:
        - scenario: Successfully validate a definition's fields
          given:
            - The ValidatorKeywordInput consists of list of keyword arguments defining fields to validate and reference type constraints.
            - The definition under test contains at least one populated field given a type constraint via arguments.
            - The definition fields subject to validation match the constrained field type.
          when:
            - The ValidatorInput is validated
          then:
            - The ValidatorOutput does not indicate any errors
            - The ValidatorOutput does not indicate any warnings
            - The ValidatorOutput indicates the definition under test is valid
        - scenario: Fail to validate a definition's fields
          given:
            - The ValidatorKeywordInput consists of list of keyword arguments defining fields to validate and reference type constraints.
            - The definition under test contains at least one populated field given a type constraint via arguments.
            - The definition fields subject to validation do not match the field types constraint.
          when:
            - The ValidatorInput is validated
          then:
            - The ValidatorOutput has errors
            - The ValidatorOutput errors indicate that the field(s) do not match the type constraint.
